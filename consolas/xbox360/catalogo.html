<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Cat√°logo de juegos | GameTechSolutions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="/assets/img/favicon.png">

  <!-- Base global -->
  <link rel="stylesheet" href="/styles/theme-base.css">
  <!-- Tema consola -->
  <link rel="stylesheet" href="/styles/theme-microsoft.css">
</head>
<body>

<!-- HEADER -->
<div id="header-container"></div>

<!-- üîí VALIDACI√ìN TEMPRANA DE CONTEXTO -->
<script>
(function () {
  const ctx = window.GTSContext?.load?.();

  const allowsGames =
    ctx?.services?.some(s =>
      ['games_only', 'storage_with_games'].includes(s)
    );

  if (!ctx || !ctx.services?.length || !allowsGames || !ctx.storage) {
    alert(
      'El cat√°logo solo est√° disponible cuando seleccionas un servicio con juegos y almacenamiento.'
    );
    window.location.href = '/consolas/xbox360/';
  }
})();
</script>

<main>
  <div class="container">

    <!-- INTRO -->
    <section>
      <h2>¬øC√≥mo funciona el cat√°logo?</h2>
      <p>
        Desde aqu√≠ puedes consultar los juegos disponibles para
        <strong class="consoleFull"></strong>.
        La cantidad final de juegos instalados depende del tama√±o del disco duro
        y del peso de cada t√≠tulo.
      </p>
      <p>
        Este cat√°logo sirve como referencia para que elijas tus juegos
        al momento de contratar el servicio.
      </p>
    </section>

    <!-- CONTEXTO DEL SERVICIO -->
    <section class="alert info">
      <p id="catalogContext"></p>
    </section>

    <!-- NOTAS -->
    <section>
      <h2>Notas importantes</h2>
      <div class="cards-grid">
        <div class="card">
          <h3>üíæ Espacio disponible</h3>
          <p>No todos los juegos caben en todos los discos.</p>
        </div>
        <div class="card">
          <h3>‚ö†Ô∏è Compatibilidad</h3>
          <p>Algunos t√≠tulos pueden requerir configuraciones especiales.</p>
        </div>
        <div class="card">
          <h3>üõ°Ô∏è Garant√≠a</h3>
          <p>Los juegos instalados cuentan con garant√≠a de 30 d√≠as.</p>
        </div>
      </div>
    </section>

    <!-- TOP JUEGOS -->
    <section>
      <h2>Juegos m√°s populares</h2>
      <p>
        Contamos con un amplio cat√°logo que incluye muchos de los t√≠tulos
        m√°s populares de <strong class="consoleFull"></strong>.
      </p>

      <div class="cards-grid">

        <div class="card cover-card">
          <div class="cover-wrapper">
            <img src="/assets/img/consolas/xbox360/top/gta-iv.jpg" alt="GTA IV">
            <div class="cover-overlay">Disponible</div>
          </div>
          <h3>Grand Theft Auto IV</h3>
        </div>

        <div class="card cover-card">
          <div class="cover-wrapper">
            <img src="/assets/img/consolas/xbox360/top/gtav.jpg" alt="GTA V">
            <div class="cover-overlay">Disponible</div>
          </div>
          <h3>Grand Theft Auto V</h3>
        </div>

        <div class="card cover-card">
          <div class="cover-wrapper">
            <img src="/assets/img/consolas/xbox360/top/bioshock.jpg" alt="Bioshock">
            <div class="cover-overlay">Disponible</div>
          </div>
          <h3>Bioshock</h3>
        </div>

        <div class="card cover-card">
          <div class="cover-wrapper">
            <img src="/assets/img/consolas/xbox360/top/orange-box.jpg" alt="The Orange Box">
            <div class="cover-overlay">Disponible</div>
          </div>
          <h3>The Orange Box</h3>
        </div>

        <div class="card cover-card">
          <div class="cover-wrapper">
            <img src="/assets/img/consolas/xbox360/top/mass-effect-2.jpg" alt="Mass Effect 2">
            <div class="cover-overlay">Disponible</div>
          </div>
          <h3>Mass Effect 2</h3>
        </div>

      </div>
    </section>

    <!-- ALMACENAMIENTO (SOLO VISUAL) -->
    <section>
      <h2>Almacenamiento seleccionado</h2>
      <p class="selector-note">
        El tama√±o del disco duro se defini√≥ en el paso anterior seg√∫n tu servicio.
      </p>

      <div class="disk-selector" id="storageDisplay"></div>
    </section>

    <!-- SELECTOR -->
    <section>
      <h2>Selector de juegos</h2>
      <p>Selecciona los juegos que te gustar√≠a instalar.</p>

      <div class="selector-layout">

        <!-- CAT√ÅLOGO -->
        <div class="selector-catalog">
          <h3>Cat√°logo</h3>
        </div>

        <!-- RESUMEN -->
        <div class="selector-summary">
          <h3>Mi selecci√≥n</h3>

          <p>üéÆ Juegos seleccionados: <strong id="gameCount">0</strong></p>
          <p>üíæ Espacio estimado: <strong id="totalSize">0</strong> GB</p>

          <div class="selection-actions">
            <button class="btn-small" id="saveSelection">Guardar selecci√≥n</button>
            <button class="btn-small" id="removeLast">Quitar √∫ltimo</button>
            <button class="btn-small danger" id="clearAll">Vaciar selecci√≥n</button>
          </div>

          <p class="selector-note">
            El espacio es aproximado y puede variar seg√∫n el formato del juego.
          </p>
        </div>

      </div>
    </section>

  </div>
</main>

<footer>
  <p>GameTechSolutions ¬©Ô∏è 2026</p>
</footer>

<!-- CONFIG -->
<script>
  window.CONSOLE_CONFIG = {
    code: 'X360',
    name: 'Xbox 360',
    short: 'X360',
    fullName: 'Xbox 360',
    brand: 'microsoft',
    gamesJson: '/assets/data/xbox360-games.json',
    catalogPath: '/consolas/xbox360/catalogo.html'
  };
</script>

<script src="/assets/js/context.js"></script>
<script src="/assets/js/header.js"></script>
<script src="/assets/js/catalogo-base.js"></script>

<!-- CONTEXTO + BLOQUEOS -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const ctx = window.GTSContext.load();

  // Mostrar contexto del servicio
  const ctxEl = document.getElementById('catalogContext');
  if (ctxEl) {
    const mode = ctx.services.includes('games_only')
      ? 'usando tu disco duro'
      : 'con disco duro incluido';

    ctxEl.textContent =
      `Est√°s seleccionando juegos ${mode} (${ctx.storage.label}).`;
  }

  // Mostrar almacenamiento (solo lectura)
  const storageDisplay = document.getElementById('storageDisplay');
  if (storageDisplay && ctx.storage) {
    storageDisplay.innerHTML = `
      <div class="disk-option selected">
        <strong>${ctx.storage.label}</strong>
        <span>Espacio usable: ${ctx.storage.usableGB} GB</span>
      </div>
    `;
  }

  // Bloquear radios si existen por compatibilidad
  document.querySelectorAll('input[name="diskSize"]').forEach(r => {
    r.disabled = true;
  });

  // Validaci√≥n extra antes de guardar selecci√≥n
  const saveBtn = document.getElementById('saveSelection');
  if (saveBtn) {
    saveBtn.addEventListener('click', () => {
      const ctxNow = window.GTSContext.load();
      if (!ctxNow.storage) {
        alert('No se detect√≥ almacenamiento v√°lido.');
      }
    });
  }
});
</script>

</body>
</html>